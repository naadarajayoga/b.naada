<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Naada Raja Yoga</title>
  <meta name="description" content="Naada Raja Yoga — Personalized classes and philosophy" />
  <link rel="manifest" href="/manifest.json">
  <link rel="icon" href="/favicon.ico/favicon.ico">
  <link href="https://fonts.googleapis.com/css2?family=Marcellus&family=Playfair+Display:ital,wght@0,500;0,700;1,400&display=swap" rel="stylesheet">
  <style>
    :root { --bottom-bar-h: 65px; --content-max-w: 1100px; --accent: #f39c12; }
    * { margin:0; padding:0; box-sizing:border-box; font-family: Arial, sans-serif; }
    html,body { height:100%; }
    body { background:#fff; color:#222; -webkit-font-smoothing:antialiased; }
    img{ max-width:100%; display:block; }
    #page-root{ min-height:100vh; display:flex; flex-direction:column; }
    #header-slot, #navbar-slot, #footer-slot { width:100%; }
    main#app { width:100%; max-width:var(--content-max-w); margin:20px auto; padding:12px 18px; box-sizing:border-box; flex:1 0 auto; }
    .container-section { max-width:var(--content-max-w); margin:0 auto; padding:8px 6px; box-sizing:border-box; }
    .sr-only { position:absolute !important; width:1px; height:1px; padding:0; margin:-1px; overflow:hidden; clip:rect(0,0,0,0); white-space:nowrap; border:0; }
  </style>
</head>
<body>
  <div id="page-root">
    <div id="header-slot" aria-hidden="true"></div>
    <main id="app" role="main" aria-live="polite"></main>
    <div id="footer-slot" aria-hidden="true"></div>
    <div id="navbar-slot" aria-hidden="true"></div>
  </div>

  <!-- Header template -->
  <template id="tmpl-header">
    <style>
      .branding { display:flex; gap:12px; align-items:center; justify-content:center; padding:20px; border-bottom:1px solid #eee; }
      .branding img { width:80px; }
      .branding h1 { font-family:'Marcellus', serif; font-size:2.0rem; margin-bottom:2px; }
      .branding p { font-family:'Playfair Display', serif; font-style:italic; color:#555; margin:0; }
      @media (max-width:700px){ .branding img{ width:65px; } .branding h1{ font-size:1.6rem; } }
    </style>

    <header role="banner">
      <div class="branding">
        <img src="/images/Naada Raja Yoga Logo.png" alt="Naada Raja Yoga Logo">
        <div>
          <h1>Naada Raja Yoga</h1>
          <p>Personalized Yoga Journey</p>
        </div>
      </div>
    </header>

    <script>
      (function(){ console.log('header injected'); })();
    </script>
  </template>

  <!-- Navbar template -->
  <template id="tmpl-navbar">
    <style>
      .bottom-navbar {
        --bar-h: var(--bottom-bar-h);
        position: fixed; left:0; right:0; bottom:0; height:var(--bar-h);
        display:flex; justify-content:center; align-items:center; gap:40px;
        background: linear-gradient(135deg,#2c3e50 0%,#34495e 100%); color:#ecf0f1;
        z-index:9999; backdrop-filter: blur(10px); border-top:1px solid rgba(255,255,255,0.08);
      }
      .bottom-navbar .nav-item { display:inline-flex; flex-direction:column; align-items:center; gap:4px; padding:8px 12px; border-radius:12px; color:inherit; text-decoration:none; cursor:pointer; font-size:12px; font-weight:600; position:relative; transition:all .25s; }
      .bottom-navbar .nav-item::before { content:''; position:absolute; inset:0; border-radius:12px; background:rgba(243,156,18,0.08); opacity:0; transition:all .25s; z-index:-1; }
      .bottom-navbar .nav-item:hover{ transform:translateY(-3px); color:var(--accent); }
      .bottom-navbar .nav-item:hover::before{ opacity:1; }
      .bottom-navbar svg{ width:24px; height:24px; fill:currentColor; transition:all .25s; }
      .bottom-navbar .nav-item.active{ color:var(--accent); }
      .bottom-navbar .nav-item.active svg{ transform:scale(1.08); filter:drop-shadow(0 0 8px rgba(243,156,18,0.45)); }
      @media (max-width:520px){ .bottom-navbar{ --bar-h:70px; gap:10px; justify-content:space-around; } .bottom-navbar svg{ width:22px; height:22px; } }
    </style>

    <nav class="bottom-navbar" id="site-navbar" role="navigation" aria-label="Main navigation">
      <a class="nav-item" href="/contact" data-target="contact" aria-label="Contact">
        <svg viewBox="0 0 24 24" aria-hidden="true" focusable="false"><path d="M6.6 10.2a15.05 15.05 0 006.2 6.2l1.8-1.8a1 1 0 01.9-.24c1 .25 2 .38 3 .38a1 1 0 011 1v3a1 1 0 01-1 1C9.2 23 1 14.8 1 3a1 1 0 011-1h3a1 1 0 011 1c0 1.1.13 2.1.38 3a1 1 0 01-.24.9L6.6 10.2z"/></svg>
        <span>Contact</span>
      </a>

      <a class="nav-item" href="/" data-target="home" aria-label="Home">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512" aria-hidden="true" focusable="false"><path d="M541 229.16l-61-52.06V56c0-13.25-10.75-24-24-24h-72c-13.25 0-24 10.75-24 24v24L314.4 43c-15.9-13.6-39.3-13.6-55.2 0L35 229.2c-9.9 8.4-11.1 23.3-2.7 33.2s23.3 11.1 33.2 2.7L96 232.1V456c0 30.9 25.1 56 56 56h96V360h80v152h96c30.9 0 56-25.1 56-56V232l30.6 26c9.9 8.4 24.8 7.1 33.2-2.7 8.4-9.9 7.1-24.8-2.7-33.2z"/></svg>
        <span>Home</span>
      </a>

      <a class="nav-item" href="/courses" data-target="courses" aria-label="Courses">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512" aria-hidden="true" focusable="false"><path d="M320 96a64 64 0 1 0 0-128 64 64 0 1 0 0 128zM528 352h-56l-41-82c-6-12-19-18-32-14s-21 16-19 29l20 99H240l20-99c2-13-5-25-19-29s-26 2-32 14l-41 82H112c-27 0-48 21-48 48s21 48 48 48h416c27 0 48-21 48-48s-21-48-48-48z"/></svg>
        <span>Courses</span>
      </a>
    </nav>

    <script>
      (function(){ console.log('navbar injected'); })();
    </script>
  </template>

  <!-- Footer template -->
  <template id="tmpl-footer">
    <style>
      .peek-footer { background:#fff; color:#000; width:100%; }
      .peek-footer__spacer{ height:4px; width:100%; }
      .peek-footer__hidden{ max-width:var(--content-max-w); margin:0 auto; padding:10px 18px; padding-bottom: calc(var(--bottom-bar-h) + 2px); text-align:center; box-sizing:border-box; }
      .footer-links { display:flex; gap:16px; justify-content:center; flex-wrap:wrap; }
      .footer-links a { color:#bdbdbd; text-decoration:none; padding:4px 6px; border-radius:6px; }
      .footer-links a:hover{ color:#000; text-decoration:underline; }
    </style>

    <footer class="peek-footer" id="site-footer" aria-label="Site footer">
      <div class="peek-footer__spacer" aria-hidden="true"></div>
      <div class="peek-footer__hidden" role="region" aria-label="Footer expanded links">
        <nav class="footer-links" aria-label="Footer links">
          <a href="https://naadaraja.com/privacy" data-target="privacy">Privacy Policy</a>
          <a href="https://naadaraja.com/terms" data-target="terms">Terms &amp; Conditions</a>
          <a href="https://naadaraja.com/refund" data-target="refund">Refund Policy</a>
        </nav>
      </div>
    </footer>

    <script>(function(){ console.log('footer injected'); })();</script>
  </template>

  <!-- Home template -->
  <template id="tmpl-home">
    <style>
      .home-hero{ text-align:center; padding:24px 8px; }
      .home-hero h1{ font-size:2rem; margin-bottom:8px; }
      .home-features{ display:flex; gap:12px; justify-content:center; flex-wrap:wrap; margin-top:12px; }
      .home-card{ border:1px solid #eee; padding:12px; border-radius:8px; width:220px; box-shadow:0 1px 4px rgba(0,0,0,0.04); }
    </style>

    <section id="home-container" class="container-section">
      <div class="home-hero">
        <h1>Welcome — Home</h1>
        <p>Personalized online classes, progressive plans, and supportive guidance.</p>
      </div>
      <div class="home-features" aria-hidden="false">
        <article class="home-card"><h3>Daily Lessons</h3><p>Short guided sessions for steady progress.</p></article>
        <article class="home-card"><h3>Philosophy</h3><p>Vedanta & practice context.</p></article>
        <article class="home-card"><h3>1:1 Coaching</h3><p>Personalized attention and plans.</p></article>
      </div>
    </section>

    <script>(function(){ console.log('home loaded'); })();</script>
  </template>

  <!-- About template -->
  <template id="tmpl-about">
    <style>
      .about { max-width:900px; margin:0 auto; line-height:1.6; padding:12px; }
      .about h1 { margin-bottom:8px; }
    </style>

    <section id="about-container" class="container-section about">
      <h1>About Naada Raja Yoga</h1>
      <p>We practice traditional methods blended with modern pedagogy. (Edit this paragraph to include your biography, certifications and story.)</p>
    </section>

    <script>(function(){ console.log('about loaded'); })();</script>
  </template>

  <!-- Reviews template -->
  <template id="tmpl-reviews">
    <style>
      .reviews { max-width:900px; margin:0 auto; padding:12px; }
      .review { border:1px solid #eee; padding:10px; border-radius:8px; margin-bottom:8px; }
    </style>

    <section id="reviews-container" class="container-section reviews">
      <h1>Student Reviews</h1>
      <div class="review"><strong>Priya</strong><p>Great teacher — my flexibility improved quickly.</p></div>
      <div class="review"><strong>Arjun</strong><p>Clear instructions and patient guidance.</p></div>
    </section>

    <script>(function(){ console.log('reviews loaded'); })();</script>
  </template>

  <!-- Contact template -->
  <template id="tmpl-contact">
    <style>.contact-card{ max-width:720px; margin:0 auto; padding:16px; border-radius:8px; border:1px solid #eee; }</style>

    <section id="contact-container" class="container-section">
      <div class="contact-card">
        <h1>Contact</h1>
        <p>Phone: +91-XXXXXXXXXX<br>Email: you@domain.com</p>
      </div>
    </section>

    <script>(function(){ console.log('contact loaded'); })();</script>
  </template>

  <!-- Courses template -->
  <template id="tmpl-courses">
    <style>.courses-grid{ display:grid; gap:12px; grid-template-columns: repeat(auto-fit,minmax(220px,1fr)); } .course{ padding:12px; border-radius:8px; border:1px solid #eee; }</style>

    <section id="courses-container" class="container-section">
      <h1>Courses</h1>
      <p>Choose a path that fits your level.</p>
      <div class="courses-grid">
        <div class="course"><h3>Beginner Yoga</h3><p>Foundations & alignment</p></div>
        <div class="course"><h3>Flexibility</h3><p>Targeted plans</p></div>
        <div class="course"><h3>Vedanta</h3><p>Philosophy discussions</p></div>
      </div>
    </section>

    <script>(function(){ console.log('courses loaded'); })();</script>
  </template>

  <!-- Privacy template -->
  <template id="tmpl-privacy">
    <style>.legal{ max-width:900px; margin:0 auto; padding:12px; line-height:1.6; }</style>

    <section id="privacy-container" class="container-section legal">
      <h1>Privacy Policy</h1>
      <p>Example privacy stub — replace with your full privacy policy text.</p>
    </section>

    <script>(function(){ console.log('privacy loaded'); })();</script>
  </template>

  <!-- Terms template -->
  <template id="tmpl-terms">
    <style>.legal{ max-width:900px; margin:0 auto; padding:12px; line-height:1.6; }</style>

    <section id="terms-container" class="container-section legal">
      <h1>Terms &amp; Conditions</h1>
      <p>Example terms stub — replace with your full terms & conditions.</p>
    </section>

    <script>(function(){ console.log('terms loaded'); })();</script>
  </template>

  <!-- Refund template -->
  <template id="tmpl-refund">
    <style>.legal{ max-width:900px; margin:0 auto; padding:12px; line-height:1.6; }</style>

    <section id="refund-container" class="container-section legal">
      <h1>Refund Policy</h1>
      <p>Example refund policy stub — replace with your official refund policy.</p>
    </section>

    <script>(function(){ console.log('refund loaded'); })();</script>
  </template>

  <!-- Router / injector (home now loads home; no home->courses special case) -->
  <script>
  (function(){
    const templates = {
      header:  { id: 'tmpl-header' },
      navbar:  { id: 'tmpl-navbar' },
      footer:  { id: 'tmpl-footer' },

      home:    { id: 'tmpl-home', path: '/' },
      about:   { id: 'tmpl-about', path: '/about' },
      reviews: { id: 'tmpl-reviews', path: '/reviews' },
      contact: { id: 'tmpl-contact', path: '/contact' },
      courses: { id: 'tmpl-courses', path: '/courses' },
      privacy: { id: 'tmpl-privacy', path: '/privacy' },
      terms:   { id: 'tmpl-terms', path: '/terms' },
      refund:  { id: 'tmpl-refund', path: '/refund' }
    };

    const headerSlot = document.getElementById('header-slot');
    const navbarSlot = document.getElementById('navbar-slot');
    const footerSlot = document.getElementById('footer-slot');
    const app = document.getElementById('app');

    function injectStatic(templateId, slot) {
      const tpl = document.getElementById(templateId);
      if (!tpl) return;
      const clone = tpl.content.cloneNode(true);
      slot.appendChild(clone);
      const scripts = slot.querySelectorAll('script');
      scripts.forEach(oldScript => {
        const newScript = document.createElement('script');
        for (let i = 0; i < oldScript.attributes.length; i++) {
          const attr = oldScript.attributes[i];
          newScript.setAttribute(attr.name, attr.value);
        }
        newScript.text = oldScript.textContent;
        oldScript.parentNode.replaceChild(newScript, oldScript);
      });
    }

    function initLayout() {
      injectStatic(templates.header.id, headerSlot);
      injectStatic(templates.footer.id, footerSlot);
      injectStatic(templates.navbar.id, navbarSlot);
      window.siteNavbar = document.getElementById('site-navbar');
    }

    function clearApp(){ while(app.firstChild) app.removeChild(app.firstChild); }

    function injectSession(templateId) {
      const tpl = document.getElementById(templateId);
      if (!tpl) {
        clearApp();
        const err = document.createElement('div');
        err.textContent = 'Content not found: ' + templateId;
        err.style.padding = '16px';
        app.appendChild(err);
        return;
      }
      clearApp();
      const node = tpl.content.cloneNode(true);
      app.appendChild(node);

      const scripts = app.querySelectorAll('script');
      scripts.forEach(oldScript => {
        const newScript = document.createElement('script');
        for (let i = 0; i < oldScript.attributes.length; i++) {
          const attr = oldScript.attributes[i];
          newScript.setAttribute(attr.name, attr.value);
        }
        newScript.text = oldScript.textContent;
        oldScript.parentNode.replaceChild(newScript, oldScript);
      });

      const firstHeading = app.querySelector('h1, h2, [role="main"]');
      if (firstHeading) {
        firstHeading.setAttribute('tabindex', '-1');
        firstHeading.focus({ preventScroll: true });
      }
      adjustAppSpacing();
    }

    function adjustAppSpacing() {
      const navbarEl = document.getElementById('site-navbar');
      const footerEl = document.getElementById('site-footer');
      const navH = navbarEl ? navbarEl.getBoundingClientRect().height : 0;
      const footH = footerEl ? footerEl.getBoundingClientRect().height : 0;
      const extra = 16;
      app.style.paddingBottom = Math.ceil(navH + footH + extra) + 'px';
    }
    window.addEventListener('resize', adjustAppSpacing);

    function setActiveNav(targetName) {
      const nav = document.getElementById('site-navbar');
      if (!nav) return;
      const items = nav.querySelectorAll('.nav-item');
      items.forEach(it => {
        if (it.dataset.target === targetName) it.classList.add('active');
        else it.classList.remove('active');
      });
    }

    function routeKeyForPath(path) {
      const p = (path || '/').replace(/^\/+|\/+$/g, '');
      if (p === '') return 'home';
      if (templates[p]) return p;
      if (p.includes('privacy')) return 'privacy';
      if (p.includes('terms')) return 'terms';
      if (p.includes('refund')) return 'refund';
      return 'home';
    }

    // loadRoute now maps nav clicks directly: home -> home, courses -> courses, etc.
    function loadRoute(routeKey, pushHistory = true) {
      if (!templates[routeKey]) routeKey = 'home';
      injectSession(templates[routeKey].id);
      setActiveNav(routeKey);
      if (pushHistory) {
        const pushPath = templates[routeKey].path || '/';
        try { history.pushState({ page: routeKey }, '', pushPath); } catch(e){}
      }
    }

    // nav clicks
    function setupNavHandlers() {
      const nav = document.getElementById('site-navbar');
      if (!nav) return;
      nav.addEventListener('click', (ev) => {
        const a = ev.target.closest('.nav-item');
        if (!a) return;
        ev.preventDefault();
        const clicked = a.dataset.target;
        // straightforward mapping: clicking Home loads home
        loadRoute(clicked, true);
      });
    }

    // footer link clicks
    function setupFooterHandlers() {
      const footer = document.getElementById('site-footer');
      if (!footer) return;
      footer.addEventListener('click', (ev) => {
        const a = ev.target.closest('a[data-target]');
        if (!a) return;
        ev.preventDefault();
        const tgt = a.dataset.target;
        if (!tgt) return;
        loadRoute(tgt, true);
      });
    }

    window.addEventListener('popstate', (ev) => {
      const state = ev.state || {};
      const page = state.page || routeKeyForPath(location.pathname);
      loadRoute(page, false);
    });

    document.addEventListener('DOMContentLoaded', () => {
      initLayout();
      setTimeout(() => {
        setupNavHandlers();
        setupFooterHandlers();
        adjustAppSpacing();
        const initial = routeKeyForPath(location.pathname);
        loadRoute(initial, false);
      }, 0);
    });

    window.__naada = { loadRoute, templates };
  })();
  </script>
</body>
</html>
