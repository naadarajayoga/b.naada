<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Naada Raja Yoga</title>

<!-- Minimal CSS only — removed padding/margin that wasted space -->
<style>
  html, body {height:100%; margin:0; font-family: Arial, system-ui, -apple-system, Segoe UI, Roboto;}
  img {max-width: 100%; display: block;}
  #page-root {min-height: 100vh; display: flex; flex-direction: column;}
  #header-slot, #navbar-slot, #footer-slot {width:100%;}
  main#app {flex:1 0 auto; width:100%; position: relative; overflow: hidden;}
  .naada-loader {padding: 24px; text-align:center; color:#666;}
  /* transition container */
  #app > .container-wrapper {position: absolute; top:0; left:0; width:100%; opacity:0; transform: translateY(15px); transition: opacity .35s ease, transform .35s ease;}
  #app > .container-wrapper.active {opacity:1; transform: translateY(0);}
</style>
</head>
<body>

<div id="page-root">
  <div id="header-slot" aria-hidden="true"></div>
  <main id="app" role="main" aria-live="polite"></main>
  <div id="footer-slot" aria-hidden="true"></div>
  <div id="navbar-slot" aria-hidden="true"></div>
</div>

<!-- Header template -->
<template id="tmpl-header">
  <style>
    header {padding: 20px; border-bottom: 1px solid #eee; display: flex; justify-content:center;}
    .branding{display:flex; gap:12px; align-items:center; max-width:1100px; width:100%; justify-content:center;}
    .branding img{width:80px;}
    .branding h1{font-family:'Marcellus',serif;margin:0;font-size:1.9rem;}
    .branding p{font-family:'Playfair Display',serif;margin:0;color:#555;font-style:italic;}
    @media (max-width:700px){.branding img{width:65px} .branding h1{font-size:1.6rem}}
  </style>
  <header role="banner">
    <div class="branding">
      <img src="/images/Naada Raja Yoga Logo.png" alt="Naada Raja Yoga Logo">
      <div>
        <h1>Naada Raja Yoga</h1>
        <p>Personalized Yoga Journey</p>
      </div>
    </div>
  </header>
</template>

<!-- Navbar template -->
<template id="tmpl-navbar">
  <style>
    .bottom-navbar {position: fixed; left:0; right:0; bottom:0; height:65px; display:flex; justify-content:center; align-items:center; gap:40px; background:linear-gradient(135deg,#2c3e50,#34495e); color:#ecf0f1; z-index:9999; backdrop-filter:blur(10px); border-top:1px solid rgba(255,255,255,.08);}
    .nav-item {display:inline-flex; flex-direction:column; align-items:center; gap:4px; padding:8px 12px; border-radius:12px; color:inherit; text-decoration:none; cursor:pointer; font-weight:600; transition:.25s;}
    .nav-item.active {color:#f39c12;}
    .nav-item svg{width:24px; height:24px; fill:currentColor;}
  </style>
  <nav class="bottom-navbar" id="site-navbar" role="navigation" aria-label="Main navigation">
    <a class="nav-item" href="#/home" data-target="home" aria-label="Home">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><path d="M541 229.16l-61-52.06V56c0-13.25-10.75-24-24-24h-72c-13.25 0-24 10.75-24 24v24L314.4 43c-15.9-13.6-39.3-13.6-55.2 0L35 229.2c-9.9 8.4-11.1 23.3-2.7 33.2s23.3 11.1 33.2 2.7L96 232.1V456c0 30.9 25.1 56 56 56h96V360h80v152h96c30.9 0 56-25.1 56-56V232l30.6 26c9.9 8.4 24.8 7.1 33.2-2.7 8.4-9.9 7.1-24.8-2.7-33.2z"/></svg>
      <span>Home</span>
    </a>
    <a class="nav-item" href="#/courses" data-target="courses" aria-label="Courses">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512"><path d="M320 96a64 64 0 1 0 0-128 64 64 0 1 0 0 128zM528 352h-56l-41-82c-6-12-19-18-32-14s-21 16-19 29l20 99H240l20-99c2-13-5-25-19-29s-26 2-32 14l-41 82H112c-27 0-48 21-48 48s21 48 48 48h416c27 0 48-21 48-48s-21-48-48-48z"/></svg>
      <span>Courses</span>
    </a>
    <a class="nav-item" href="#/contact" data-target="contact" aria-label="Contact">
      <svg viewBox="0 0 24 24" aria-hidden="true"><path d="M6.6 10.2a15.05 15.05 0 006.2 6.2l1.8-1.8a1 1 0 01.9-.24c1 .25 2 .38 3 .38a1 1 0 011 1v3a1 1 0 01-1 1C9.2 23 1 14.8 1 3a1 1 0 011-1h3a1 1 0 011 1c0 1.1.13 2.1.38 3a1 1 0 01-.24.9L6.6 10.2z"/></svg>
      <span>Contact</span>
    </a>
  </nav>
</template>

<!-- Footer template -->
<template id="tmpl-footer">
  <style>
    .peek-footer{background:#fff;color:#000;text-align:center;padding:12px 0;}
    .footer-links{display:flex;justify-content:center;gap:16px;flex-wrap:wrap;}
    .footer-links a{color:#bdbdbd;text-decoration:none;padding:4px 6px;border-radius:6px;}
    .footer-links a:hover{color:#000;text-decoration:underline;}
  </style>
  <footer class="peek-footer" id="site-footer" aria-label="Site footer">
    <nav class="footer-links" aria-label="Footer links">
      <a href="#/privacy" data-target="privacy">Privacy Policy</a>
      <a href="#/terms" data-target="terms">Terms &amp; Conditions</a>
      <a href="#/refund" data-target="refund">Refund Policy</a>
    </nav>
  </footer>
</template>

<!-- ===== Main Script ===== -->
<script>
(function(){
  const containerFiles = {
    home:    '/home.html',
    contact: '/contact.html',
    courses: '/courses.html',
    privacy: '/privacy.html',
    terms:   '/terms.html',
    refund:  '/refund.html'
  };
  const headerSlot = document.getElementById('header-slot');
  const navbarSlot = document.getElementById('navbar-slot');
  const footerSlot = document.getElementById('footer-slot');
  const app = document.getElementById('app');
  const cache = {};

  function injectTemplate(templateId, slot){
    const tpl = document.getElementById(templateId);
    if(!tpl) return;
    const clone = tpl.content.cloneNode(true);
    slot.appendChild(clone);
  }

  function initChrome(){
    injectTemplate('tmpl-header', headerSlot);
    injectTemplate('tmpl-footer', footerSlot);
    injectTemplate('tmpl-navbar', navbarSlot);
  }

  function setActiveNav(name){
    const nav = document.getElementById('site-navbar');
    if(!nav) return;
    nav.querySelectorAll('.nav-item').forEach(it=>{
      it.classList.toggle('active', it.dataset.target===name);
    });
  }

  function showLoading(){
    app.innerHTML = '<div class="naada-loader">Loading…</div>';
  }

  async function fetchContainer(routeKey){
    if(!containerFiles[routeKey]) throw new Error('Unknown route ' + routeKey);
    if(cache[routeKey]) return cache[routeKey];
    const res = await fetch(containerFiles[routeKey], {cache:'no-store'});
    if(!res.ok) throw new Error('Failed to fetch ' + containerFiles[routeKey]);
    const text = await res.text();
    cache[routeKey] = text;
    return text;
  }

  function extractContainer(htmlText){
    const tmp = document.createElement('template');
    tmp.innerHTML = htmlText;
    const root = Array.from(tmp.content.children).find(el=>el.id && el.id.endsWith('-container'));
    return root ? root.cloneNode(true) : tmp.content.cloneNode(true);
  }

  function injectContainer(containerEl){
    // fade/slide transition wrapper
    const wrapper = document.createElement('div');
    wrapper.classList.add('container-wrapper');
    wrapper.appendChild(containerEl);
    const old = app.firstChild;
    app.appendChild(wrapper);
    // trigger animation
    requestAnimationFrame(()=> wrapper.classList.add('active'));
    // remove old
    if(old) old.remove();
    // execute scripts in container
    wrapper.querySelectorAll('script').forEach(s=>{
      const ns = document.createElement('script');
      [...s.attributes].forEach(a=>ns.setAttribute(a.name,a.value));
      ns.text = s.textContent;
      document.head.appendChild(ns);
      document.head.removeChild(ns);
    });
  }

  async function loadRoute(routeKey, pushHistory=true){
    if(!containerFiles[routeKey]) routeKey='home';
    setActiveNav(routeKey);
    showLoading();
    try{
      const html = await fetchContainer(routeKey);
      const container = extractContainer(html);
      injectContainer(container);
      if(pushHistory){
        const newHash = '#/' + routeKey;
        if(location.hash!==newHash) location.hash=newHash;
      }
    } catch(e){
      console.error(e);
      app.innerHTML='<div class="naada-loader">Could not load content.</div>';
    }
  }

  function routeFromHash(h){
    const hash = (h||location.hash||'#/home').replace(/^#\/?/,'');
    return containerFiles[hash] ? hash : 'home';
  }

  function setupNavClicks(){
    const nav = document.getElementById('site-navbar');
    if(!nav) return;
    nav.addEventListener('click', ev=>{
      const a = ev.target.closest('.nav-item');
      if(!a) return;
      ev.preventDefault();
      const key = a.dataset.target;
      if(key) loadRoute(key,true);
    });
  }

  function setupFooterClicks(){
    const foot = document.getElementById('site-footer');
    if(!foot) return;
    foot.addEventListener('click', ev=>{
      const a = ev.target.closest('a[data-target]');
      if(!a) return;
      ev.preventDefault();
      loadRoute(a.dataset.target,true);
    });
  }

  function setupAppLinkDelegation(){
    document.addEventListener('click', ev=>{
      const a = ev.target.closest('a');
      if(!a) return;
      if(a.target==='_blank'||a.hasAttribute('download')) return;
      const href = a.getAttribute('href');
      if(!href||href.startsWith('#')) return;
      let url;
      try {url=new URL(href,location.href);} catch(e){return;}
      if(url.origin!==location.origin) return;
      const path=url.pathname.replace(/^\/+|\/+$/g,'')||'home';
      if(containerFiles[path]){ev.preventDefault(); loadRoute(path,true);}
    });
  }

  // prefetch all containers after first load
  function prefetchContainers(){
    Object.keys(containerFiles).forEach(k=>{
      if(!cache[k]) fetchContainer(k).catch(()=>{});
    });
  }

  window.addEventListener('hashchange', ()=> loadRoute(routeFromHash(location.hash), false));

  document.addEventListener('DOMContentLoaded', ()=>{
    initChrome();
    setupNavClicks();
    setupFooterClicks();
    setupAppLinkDelegation();
    loadRoute(routeFromHash(location.hash), false).then(prefetchContainers);
  });

  window.__naada={loadRoute,cache,containerFiles};
})();
</script>

</body>
</html>
