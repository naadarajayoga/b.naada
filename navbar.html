<!-- NAVBAR: Replace your existing navbar HTML/CSS/JS with this full block -->
<nav class="bottom-navbar" id="site-navbar" role="navigation" aria-label="Main navigation">
  <a class="nav-item" href="https://b.naadaraja.com/contact" aria-label="Contact">
    <svg viewBox="0 0 24 24" aria-hidden="true" focusable="false">
      <path d="M6.6 10.2a15.05 15.05 0 006.2 6.2l1.8-1.8a1 1 0 01.9-.24c1 .25 2 .38 3 .38a1 1 0 011 1v3a1 1 0 01-1 1C9.2 23 1 14.8 1 3a1 1 0 011-1h3a1 1 0 011 1c0 1.1.13 2.1.38 3a1 1 0 01-.24.9L6.6 10.2z"/>
    </svg>
    <span>Contact</span>
  </a>

  <a class="nav-item" href="https://b.naadaraja.com" aria-label="Home">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512" aria-hidden="true" focusable="false">
      <path d="M541 229.16l-61-52.06V56c0-13.25-10.75-24-24-24h-72c-13.25 0-24 10.75-24 24v24L314.4 43c-15.9-13.6-39.3-13.6-55.2 0L35 229.2c-9.9 8.4-11.1 23.3-2.7 33.2s23.3 11.1 33.2 2.7L96 232.1V456c0 30.9 25.1 56 56 56h96V360h80v152h96c30.9 0 56-25.1 56-56V232l30.6 26c9.9 8.4 24.8 7.1 33.2-2.7 8.4-9.9 7.1-24.8-2.7-33.2z"/>
    </svg>
    <span>Home</span>
  </a>

  <a class="nav-item" href="https://b.naadaraja.com/courses" aria-label="Courses">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512" aria-hidden="true" focusable="false">
      <path d="M320 96a64 64 0 1 0 0-128 64 64 0 1 0 0 128zM528 352h-56l-41-82c-6-12-19-18-32-14s-21 16-19 29l20 99H240l20-99c2-13-5-25-19-29s-26 2-32 14l-41 82H112c-27 0-48 21-48 48s21 48 48 48h416c27 0 48-21 48-48s-21-48-48-48z"/>
    </svg>
    <span>Courses</span>
  </a>
</nav>

<style>
  .bottom-navbar {
    --bar-h: 65px;
    --bg: linear-gradient(135deg, #2c3e50 0%, #34495e 100%);
    --text: #ecf0f1;
    --accent: #f39c12;
    --transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);

    position: fixed;
    left: 0;
    right: 0;
    bottom: 0;
    height: var(--bar-h);
    display: flex;
    justify-content: center;
    align-items: center;
    gap: 50px;
    background: var(--bg);
    color: var(--text);
    z-index: 9999;
    box-shadow: 0 -4px 20px rgba(0, 0, 0, 0.2);
    backdrop-filter: blur(10px);
    border-top: 1px solid rgba(255, 255, 255, 0.1);
  }

  .bottom-navbar .nav-item {
    display: inline-flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    gap: 4px;
    color: var(--text);
    text-decoration: none;
    padding: 8px 12px;
    border-radius: 12px;
    transition: var(--transition);
    position: relative;
    cursor: pointer;
    font-size: 12px;
    font-weight: 600;
  }

  .bottom-navbar .nav-item::before {
    content: '';
    position: absolute;
    inset: 0;
    background: rgba(243, 156, 18, 0.1);
    border-radius: 12px;
    opacity: 0;
    transition: var(--transition);
    z-index: -1;
  }

  .bottom-navbar .nav-item:hover {
    transform: translateY(-3px);
    color: var(--accent);
  }

  .bottom-navbar .nav-item:hover::before {
    opacity: 1;
  }

  .bottom-navbar svg {
    width: 24px;
    height: 24px;
    display: block;
    fill: currentColor;
    transition: var(--transition);
  }

  .bottom-navbar .nav-item.active {
    color: var(--accent);
  }

  .bottom-navbar .nav-item.active svg {
    filter: drop-shadow(0 0 8px rgba(243, 156, 18, 0.5));
    transform: scale(1.1);
  }

  .bottom-navbar .nav-item.active::before {
    opacity: 1;
    background: rgba(243, 156, 18, 0.15);
  }

  @media (max-width: 520px) {
    .bottom-navbar {
      --bar-h: 70px;
      padding: 8px 10px;
      gap: 10px;
      justify-content: space-around;
    }

    .bottom-navbar .nav-item {
      padding: 6px 8px;
    }

    .bottom-navbar svg {
      width: 22px;
      height: 22px;
    }
  }
</style>

<script>
  (function () {
    'use strict';

    // Normalize a pathname: remove query/hash, treat /index.html as /, remove trailing slash
    function normalizePath(p) {
      if (!p) return '/';
      
      try {
        // Try to parse as full URL first
        const url = new URL(p, 'https://b.naadaraja.com');
        p = url.pathname;
      } catch (e) {
        // If parsing fails, just use the path as is
        p = p.split('?')[0].split('#')[0];
      }
      
      // Remove domain if present (for full URLs)
      p = p.replace(/^https?:\/\/[^/]+/, '');
      
      // Ensure it starts with /
      if (!p.startsWith('/')) p = '/' + p;
      
      // Convert /index.html to /
      if (p.endsWith('/index.html') || p.endsWith('/index.htm')) {
        p = p.slice(0, -10); // Remove index.html
        if (!p) p = '/';
      }
      
      // Remove trailing slash EXCEPT for root
      if (p.length > 1 && p.endsWith('/')) {
        p = p.slice(0, -1);
      }
      
      return p;
    }

    // Set active class on nav-items that match current page path.
    // Rules:
    // 1) Prefer exact matches (linkPath === currentPath).
    // 2) If no exact match, prefer the longest non-root prefix match (e.g. /courses for /courses/xyz).
    // 3) Only activate the root (/) link when the current path is exactly '/'. Do NOT use root as a fallback.
    function setActiveNavItems(root = document) {
      // Get current path, ignoring trailing slashes and index.html
      const currentPath = normalizePath(location.pathname);
      const nav = root.querySelector('.bottom-navbar');
      if (!nav) return;

      // Clear all active states first
      const items = Array.from(nav.querySelectorAll('.nav-item'));
      items.forEach(item => item.classList.remove('active'));

      // Process each nav item
      for (const item of items) {
        const href = item.getAttribute('href');
        if (!href) continue;

        // Normalize the link path
        const linkPath = normalizePath(href);
        
        // Special case for home page
        if (linkPath === '/') {
          // Only highlight home when exactly at root
          if (currentPath === '/') {
            item.classList.add('active');
          }
          continue; // Skip further processing for home link
        }
        
        // For other pages, check for exact match first
        if (currentPath === linkPath) {
          item.classList.add('active');
          return;
        }

        // Check if current path is under this section
        // But only if we're not at root and this isn't the home link
        if (currentPath !== '/' && 
            currentPath.startsWith(linkPath + '/')) {
          item.classList.add('active');
          return;
        }
      }
    }
    }

    // Run when DOM ready
    function domReady(fn) {
      if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', fn);
      } else {
        fn();
      }
    }

    domReady(() => {
      try {
        // Initial setup
        setActiveNavItems(document);

        // Listen for custom event if navbar loaded dynamically
        document.addEventListener('navbar:loaded', () => setActiveNavItems(document));

        // Watch for nodes being added (dynamic insertion)
        const observer = new MutationObserver((mutations) => {
          for (const m of mutations) {
            for (const node of m.addedNodes) {
              if (!(node instanceof HTMLElement)) continue;
              if (node.matches && node.matches('.bottom-navbar')) {
                setActiveNavItems(document);
                return;
              }
              if (node.querySelector && node.querySelector('.bottom-navbar')) {
                setActiveNavItems(document);
                return;
              }
            }
          }
        });
        observer.observe(document.documentElement || document.body, { childList: true, subtree: true });

        // Accessibility: keyboard navigation
        document.querySelectorAll('.bottom-navbar .nav-item').forEach(item => {
          item.setAttribute('role', 'link');
          item.addEventListener('keydown', (ev) => {
            if (ev.key === 'Enter' || ev.key === ' ') {
              ev.preventDefault();
              if (item.tagName.toLowerCase() === 'a' && item.href) {
                window.location.href = item.href;
              } else {
                item.click();
              }
            }
          });
        });
      } catch (err) {
        console.error('Navbar script error:', err);
      }
    });
  })();
</script>